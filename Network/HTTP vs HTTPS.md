# HTTP vs HTTPS

## HTTP(HyperText Transfer Protocol)

HTTP(HyperText Transfer Protocol)는 인터넷 상에서 클라이언트와 서버가 자원을 주고 받을 때 쓰는 통신 규약이다.

- 대부분의 파일 형식(HTML 파일, JSON, TEXT, IMAGE 등) 전송이 가능하다.
- 서버간에 데이터를 주고 받을 때도 대부분 HTTP를 사용한다.
- **TCP 프로토콜**을 사용한다.
  : 현재 주로 사용하는 HTTP/1.1은 TCP 프로토콜을 기반으로 한다.
  HTTP/1.1, HTTP/2 ⇒ TCP 기반
  HTTP/3 ⇒ UDP 기반
    > #### TCP vs UDP
    > **TCP(Transmission Control Protocol, 전송 제어 프로토콜)**<br>
    > - 연결지향 - TCP 3 way handshake(가상 연결) → 비연결성 해결<br>
     : 연결이 되면 데이터 전송<br>
    > - 데이터 전달 보증 → 비신뢰성 해결<br>
     : 클라이언트에서 보낸 데이터를 서버에서 받았을 경우 응답을 보내주므로 전송 중 데이터가 손실되면 송신자가 알 수 있음<br>
    > - 순서 보장 → 비신뢰성 해결<br>
     : TCP/IP는 TCP 세그먼트에 전송 제어, 순서 정보가 들어있어 데이터 전달 보증 및 순서 보장이 가능<br>
  > 
    > **UDP(User Datagram Protocol, 사용자 데이터그램 프로토콜)**
    > - 연결지향 X<br>
    > - 데이터 전달 보증 X<br>
    > - 순서 보장 X<br>
    > - 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠름
- TCP/IP 80번 포트를 사용한다.

### HTTP 특징

- 클라이언트 서버 구조이다.
  <img width="538" alt="http" src="https://user-images.githubusercontent.com/62989828/188255904-f71fe880-badd-4db9-86fa-def3c6274ef0.png">
    1. Request-Response 구조
    2. 클라이언트는 서버에 요청을 보내고 응답을 대기
    3. 서버가 요청에 대한 결과를 만들어 응답

- **무상태 프로토콜(Stateless protocol)**이다.
    - 서버가 클라이언트에 요청 자원을 보낼 때 서버는 클라이언트에 관한 어떠한 상태 정보도 저장하지 않는다.
    - 장점: 서버 확장성 높음(스케일 아웃)
        - 스케일 아웃: 서버를 여러대 추가해서 시스템을 확장하는 방법
        - 스케일 업: 서버에 CPU나 RAM 추가 등 고성능의 서버로 교환하는 방법
    - 단점: 클라이언트가 추가 데이터 전송
    - 실무적 한계
        - 모든 것을 무상태로 설계할 수 있는 경우도 있고 없는 경우도 있다.
        - 상태 유지가 필요한 경우 - 로그인
            - 로그인한 사용자의 경우 로그인했다는 상태를 서버에 유지
              → 일반적으로 브라우저 쿠키와 서버 세션 등을 사용해 상태 유지(상태 유지는 최소한만 사용)

          > #### 상태 유지(Stateful) vs 무상태(Stateless)
          > 상태 유지는 중간에 서버가 바뀌면 요청을 수행할 수 없음<br>
          무상태는 중간에 서버가 바뀌어도 요청을 수행할 수 있음<br>
          ex)<br>
          **상태 유지(Stateful)**<br>
          손님: 바닐라 딜라이트 얼마?<br>
          점원1: 5500원<br>
          손님: 2잔 달라<br>
          점원2: ???<br>
          **무상태(Stateless)**<br>
          손님: 바닐라 딜라이트 얼마?<br>
          점원1: 5500원<br>
          손님: 바닐라 딜라이트 2잔 달라<br>
          점원2: 11000원<br>

- **비연결성(Connectionless)** 모델이다.
    - HTTP 1.0 기준으로 HTTP는 연결을 유지하지 않는 모델이다.
    - 일반적으로 초 단위 이하의 빠른 속도로 응답한다.

      → 트래픽이 많지 않고, 빠른 응답을 제공할 수 있는 경우 비연결성의 특징은 효율적으로 작동

      → 1시간동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십 개로 매우 적음

      ex) 웹 브라우저에서 계속 연속해서 검색 버튼을 누르지는 않음

    - 서버 자원을 매우 효율적으로 사용할 수 있음
    - 트래픽이 많고 큰 규모의 서비스를 운영할 때는 비연결성은 한계가 있음
        - 한계
            - TCP/IP 연결을 새로 맺어야 함 → 3 way handshake 시간 추가

              (TCP/IP: 인터넷 통신에서 가장 기반이 되는 프로토콜, 대부분의 프로그램들이 TCP를 기반으로 한 IP 위에서 동작하기 때문에 흔히 이를 묶어 TCP/IP로 표현함(하지만 TCP와 IP는 계층이 나눠져있으며 역할과 책임이 명확히 다름))

            - 웹 브라우저로 사이트 요청 시 HTML 뿐만 아니라 자바스크립트, css, 추가 이미지 등 수많은 자원이 함께 다운로드 → 비효율적
        - 극복
            - HTTP 지속 연결(Persistent Connection)로 문제 해결
            - HTTP/2, HTTP/3에서 더 많은 최적화

### HTTP 약점

- 평문 통신이기 때문에 도청이 가능하다.
- 통신 상대를 확인하지 않아 위장이 가능하다.
- 완전성을 증명할 수 없기 때문에 변조가 가능하다.

## HTTPS(HyperText Transfer Protocol Secure)

HTTPS(HyperText Transfer Protocol Secure)는 인터넷 상에서 **정보를 암호화하는 SSL 프로토콜을 사용**해 클라이언트와 서버가 자원을 주고 받을 때 쓰는 통신 규약이다.

- 소켓 통신에서 일반 텍스트를 사용하는 대신 SSL이나 TLS 프로토콜을 통해 세션 데이터를 암호화한다.

  (보호의 수준은 웹 브라우저에서의 구현 정확도와 서버 스프트웨어, 지원하는 암호화 알고리즘에 달려있음)

- TCP/IP 443번 포트를 사용한다.

### HTTPS 사용 이유

1. 기밀성(Confidentiality): HTTPS는 인터넷과 같은 공공 매체에서 두 참여자 간의 통신을 보호한다.
2. 무결성(Integrity): HTTPS는 변조되지 않은 정보로 목적지에 도달하게 한다.
3. 인증(Authentication): HTTPS를 통해 웹사이트의 진위 여부를 확인할 수 있다.

### HTTPS 보안이 뛰어난 이유

- SSL 인증서

  SSL 인증서는 사용자가 사이트에 제공하는 정보를 암호화하는데, 이렇게 전송된 데이터는 중간에서 누군가 훔쳐낸다고 하더라도 데이터가 암호화되어 있기 때문에 해독할 수 없다.

  > #### SSL vs TLS
  > SSL(Secure Socket Layer)은 TLS(Transport Layer Security)의 과거 명칭이다.<br>
  (하지만 여전히 TLS 대신 SSL이라는 표현을 더 많이 사용하고 있다.)<br>
  TLS는 SSL 3.0을 기초로 해서 IETF가 만든 프로토콜로, 이는 SSL 3.0을 보다 안전하게 하고 프로토콜 스펙의 정확성과 안정성을 높이는 목적으로 고안되었다.

### HTTPS 원리

- 대칭키 암호화와 비대칭키 암호화를 모두 사용하여 **빠른 연산 속도**와 **안정성** 모두 얻음
- 대칭키 암호화
    - 클라이언트와 서버가 동일한 키를 사용해 암호화/복호화 진행한다.
    - 키가 노출되면 매우 위험하지만 **연산 속도가 빠르다.**
- 비대칭키 암호화
    - 1개의 쌍으로 구성된 **공개키**와 **개인키**를 암호화/복호화하는데 사용한다.
    - 키가 노출되어도 비교적 안전하지만 연산 속도가 느리다.
- HTTPS에서는 서버와 클라이언트 간 세션키를 교환
    1. 세션키는 주고 받는 데이터를 암호화하기 위해 사용되는 대칭키이다.
    2. 데이터 간의 교환에는 **빠른 연산 속도** 가 필요하므로 세션키는 대칭키로 만든다.
    3. 이 세션키를 클라이언트와 서버가 교환하는 과정에서 **비대칭키** 사용한다.
    4. 즉 처음 연결을 성립하여 안전하게 세션키를 공유하는 과정에서 비대칭키가 사용되며 이후 데이터 교환 과정은 대칭키 사용한다.

### HTTPS 동작 과정

1. 클라이언트(브라우저)가 서버로 최초 연결 시도한다.
2. 서버는 **공개키(엄밀히는 인증서)**를 브라우저에게 넘겨준다.
3. 브라우저는 인증서의 유효성을 검사하고 세션키를 발급한다.
4. 브라우저는 세션키를 보관하며 추가로 **서버의 공개키**로 세션키 암호화 및 서버로 전송한다.
5. 서버는 **개인키**로 암호화된 세션키를 복호화하여 세션키를 확보한다.
6. 클라이언트와 서버는 **동일한 세션키**를 공유하므로 데이터를 전달할 때 세션키로 암호화/복호화를 진행한다.

## HTTP vs HTTPS 정리

HTTP와 HTTPS 프로토콜의 가장 큰 차이는 SSL 사용 유무이다. HTTPS는 SSL 인증서를 사용해 정보를 암호화함으로써 보안 기능을 제공한다. 때문에 HTTP 프로토콜은 보안에 취약한 반면 암호화/복호화 과정이 생략되기 때문에 HTTPS 프로토콜에 비해 속도가 빠르다. 또한 HTTPS는 인증서를 발급, 유지하는 데에 있어 비용이 발생한다.

따라서 개인정보와 같은 민감한 데이터를 주고 받아야 한다면 HTTPS를 이용해야 하지만, 노출이 되어도 괜찮은(단순한) 정보만 처리한다면 HTTP 프로토콜을 이용하는 것이 유리하다.

하지만 보안적인 측면 이외에도 검색 엔진 최적화(SEO, Search Engine Optimization)에 있어서도 큰 혜택을 볼 수 있고, 가속화된 모바일 페이지(AMP, Accelerated Mobile Pages)를 만들 수 있다는 장점이 있기 때문에 HTTPS 프로토콜을 사용하는 것이 좋다.

+꼬리 질문
- SEO란?
- AMP란?